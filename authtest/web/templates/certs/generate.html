{% extends "base.html" %}

{% block title %}Generate Certificate - AuthTest{% endblock %}

{% block content %}
<div class="mb-6">
    <a href="{{ url_for('certs.index') }}" class="text-blue-600 dark:text-blue-400 hover:underline flex items-center">
        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
        Back to Certificates
    </a>
</div>

<h1 class="text-2xl font-bold mb-6">Generate Certificate</h1>

<div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 max-w-2xl">
    <form method="POST" action="{{ url_for('certs.generate') }}">
        <!-- Certificate Type -->
        <div class="mb-6">
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Certificate Type</label>
            <div class="space-y-2">
                <label class="flex items-center">
                    <input type="radio" name="cert_type" value="signing" checked class="form-radio text-blue-600">
                    <span class="ml-2">
                        <span class="font-medium">SP Signing Certificate</span>
                        <span class="block text-sm text-gray-500 dark:text-gray-400">For signing SAML AuthnRequests and assertions</span>
                    </span>
                </label>
                <label class="flex items-center">
                    <input type="radio" name="cert_type" value="tls" class="form-radio text-blue-600">
                    <span class="ml-2">
                        <span class="font-medium">TLS/Server Certificate</span>
                        <span class="block text-sm text-gray-500 dark:text-gray-400">For HTTPS server authentication (includes localhost SANs)</span>
                    </span>
                </label>
            </div>
        </div>

        <!-- Certificate Name -->
        <div class="mb-4">
            <label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Certificate Name</label>
            <input type="text" id="name" name="name" placeholder="e.g., signing, production, myapp"
                class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"
                pattern="[a-zA-Z0-9_-]+" title="Only letters, numbers, underscores, and hyphens">
            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">
                Used for file names. Leave empty for default (signing/server based on type).
            </p>
        </div>

        <!-- Common Name -->
        <div class="mb-4">
            <label for="common_name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Common Name (CN)</label>
            <input type="text" id="common_name" name="common_name" value="localhost" required
                class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white">
            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">
                Primary domain or identifier for the certificate.
            </p>
        </div>

        <!-- Organization -->
        <div class="mb-4">
            <label for="organization" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Organization (O)</label>
            <input type="text" id="organization" name="organization" value="AuthTest"
                class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white">
        </div>

        <!-- Validity Period -->
        <div class="mb-4">
            <label for="days_valid" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Validity Period (days)</label>
            <input type="number" id="days_valid" name="days_valid" value="365" min="1" max="3650" required
                class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white">
            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">
                How long the certificate will be valid. Maximum 10 years (3650 days).
            </p>
        </div>

        <!-- Overwrite Option -->
        <div class="mb-6">
            <label class="flex items-center">
                <input type="checkbox" name="force" class="form-checkbox text-blue-600 rounded">
                <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Overwrite if certificate already exists</span>
            </label>
        </div>

        <!-- Submit -->
        <div class="flex justify-end space-x-3">
            <a href="{{ url_for('certs.index') }}" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                Cancel
            </a>
            <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">
                Generate Certificate
            </button>
        </div>
    </form>
</div>

<div class="mt-6 bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 max-w-2xl">
    <h3 class="text-sm font-medium text-blue-800 dark:text-blue-200 mb-2">About Self-Signed Certificates</h3>
    <p class="text-sm text-blue-700 dark:text-blue-300">
        Self-signed certificates are suitable for development and testing purposes.
        For production SAML deployments, you may want to use certificates from a trusted Certificate Authority (CA)
        or import your organization's certificates.
    </p>
</div>
{% endblock %}
